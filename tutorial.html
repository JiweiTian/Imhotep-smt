<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Imhotep-SMT</title>
<link href="css/style2.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
  });
</script>
<script type="text/javascript"
   src="./MathJax-2.4-latest/MathJax.js?config=TeX-AMS_HTML-full">
</script>
<link rel="icon" href="./images/papyrus.ico" type="image/x-icon" />
<link rel="shortcut icon" href="./images/papyrus.ico" type="image/x-icon" />
</head>
<body>
<div id="wrapper">
  <div id="content">
    <div id="header">
      <div id="logo">
        <h1> <img src="./images/Imhotep.png" alt="University of California, Berkeley" style="width:150px;height:230px"> </h1>
        <!--
        <h4>have your punchline here</h4>
        -->
      </div>
      <div id="links">
        <ul> 
          <li><a href="index.html">Home</a></li>
          <li><a href="tutorial.html">Tutorial</a></li>
          <li><a href="downloads.html">Downloads</a></li>
          <li><a href="examples.html">Examples</a></li>
        </ul>
      </div>
    </div>
    <div id="mainimg">
      <h3>Imhotep-SMT</h3>
      <h4>A novel SMT-based solver for secure state estimation</h4>
    </div>
    <div id="contentarea">
      <div id="leftbar">
      	<h2>Tutorial: Securing an Unmanned Ground Vehicle</h2>
      	<p>
      	In this tutorial, we are going to demonstrate how to use Imhotep-SMT to secure the control of 
      	an unmanned ground vehicle (UGV) against attacks to its sensors. The UGV
      	has two state variables: the position $x(t)$ and the velocity $v(t)$. A model for the time evolution 
      	of these variables, as derived using energy conservation laws, can be expressed as follows:
      	\begin{equation*}
      		\begin{bmatrix} \dot{x} \\ \dot{v} \end{bmatrix}
      			= \begin{bmatrix}0    & 1\\0   & \frac{-B}{M} \end{bmatrix} 
      			\begin{bmatrix} x(t) \\ v(t) \end{bmatrix} + 
      			\begin{bmatrix} 0 \\ \frac{1}{M}\end{bmatrix} F(t),
      	\end{equation*}
      	where $M$ and $B$ denote, respectively, the mechanical mass and the translational friction
		coefficients, while $F(t)$ is the input force to the UGV at time $t$. The UGV is
		equipped with a GPS sensor, which measures its position, and
		two motor encoders, which measure the translational velocity.
		The resulting output equation is:
		\begin{equation*}
			\begin{bmatrix} y_{\text{GPS}}(t) \\ y_{\text{right encoder}}(t) \\ y_{\text{left encoder}}(t) \end{bmatrix} = 
			\begin{bmatrix} 1 & 0 \\ 0 & 1 \\ 0 & 1 \end{bmatrix} \begin{bmatrix} x(t) \\ v(t) \end{bmatrix}
			+
			\begin{bmatrix}\psi_{\text{GPS}}(t) \\ \psi_{\text{right encoder}}(t) \\ \psi_{\text{left encoder}}(t)\end{bmatrix},
		\end{equation*}
		where $\psi$ is the measurement noise at each sensor. These sensor measurements are used
		to estimate the states of the UGV. However, we assume that an adversarial attacker is 
		manipulating one of the UGV sensors in order to deceive the state estimator. In 
		the remaining of this tutorial, we will show how Imhotep-SMT can be used to detect 
		the existence of such an attacker, and estimate the actual state of the UGV.
		</p>
		
		<br />
		


      	
      	
        <h2>Step 0: Download Imhotep-SMT</h2>
        <p>
        <ul>
        	<li> Download the latest version of Imhotep-SMT from 
        <a href="https://github.com/nesl/Imhotep-smt/releases">github</a> as a zip file. </li>
        	<li> Extract the contents of the zip file to "folder_path/ImhotepSMT".</li>
        	<li> Open Matlab, add "folder_path/ImhotepSMT/" to your Matlab path
        	 (e.g. by selecting "File->Set path->Add folder" from the main Menu in Matlab).</li>
        </ul>
        </p>
    	
        <br />
        
        <h2>Step 1: Initialize the Solver</h2>
        <p>
        	From the Matlab terminal, create a new instance of the Imhotep-SMT solver as follows:
        </p>
        
        <div class="content">
        <pre class="codeinput">smt = ImhotepSMT();</pre>
		</div>
		
		
		
        <br />
        
        <h2>Step 2: Offline Configuration of the Solver</h2> 
        <p> Imhotep-SMT must be configured offline by specifying:
			<ol>
        		<li> A discrete-time dynamical model of the system in the state space, e.g. by specifying 
        		how the state evolves over time as well as how 
        		the sensor measurements are related to the system state.</li>
        		<li> The maximum number of sensors that can be under attack for the estimation to be 
        		theoretically feasible.</li>
        		<li> A set of sensors which is known to be attack-free <i>a priori</i> (this is an optional 
        		parameter).</li>        		
        		<li> The upper bound on the magnitude (norm) of the measurement noise.</li>
        	</ol>
        </p>
        <p>	
        <b> 1- Discrete-time dynamic model.</b>
		Since our solver only accepts discrete-time models, we start by discretizing the UGV model. 
		For $M = 0.8$ and $B = 1$ and a sampling time $T_s = 100 ms$, we obtain:
      	
      	\begin{equation*}
      		\begin{bmatrix} x(t+1) \\ v(t+1) \end{bmatrix}
      			= \begin{bmatrix}1.0000    & 0.0099\\0   & 0.9876 \end{bmatrix} 
      			\begin{bmatrix} x(t) \\ v(t) \end{bmatrix} + 
      			\begin{bmatrix} 0.0001 \\ 0.0124\end{bmatrix} F(t),
      	\end{equation*}
		 which can be specified in Matlab as:
        <div class="content">
        <pre class="codeinput">A = [1 0.0099; 0 0.9876];
B = [0.0001; 0.0124];
C = [1 0; 0 1; 0 1];
ugv = ss(A,B,C,0,0.001);</pre>
		</div>
		</p>
		
		<p>
		<b> 2- Maximum number of sensors that can be under attack.</b>
		As discussed above, the attacker can attack only one sensor.
		This can be specified as follows:
		<div class="content">
        <pre class="codeinput">max_sensors_under_attack = int8(1);</pre>
		</div>
		</p>
		
		<p>
		<b> 3- Set of safe sensors.</b>
		To show how Imhotep-SMT analyzes the system specification, we initially 
		assume that the attacker can attack any of the three sensors. We will then
		show how Imhotep-SMT can actually identify which sensors <i>must</i> be secured for 
		the UGV to operate safely.
		
		<div class="content">
        <pre class="codeinput">safe_sensors = [];</pre>
		</div>
		</p>
		
		
		
        
        <p>
		<b> 4- Upper bound on measurement noise.</b>
		In general, each sensor measurement suffers from noise. The bound on this 
		noise is an important parameter which affects the capability of Imhotep-SMT to distinguish between 
		noise and attack. In this example, we assume that all sensors are ideal and are not affected by 
		noise, as follows:
		<div class="content">
        <pre class="codeinput">noise_bound = [0; 0; 0];</pre>
		</div>
		</p>
        
        <p>
        We can now initialize the SMT solver using the init() method as:
        <div class="content">
        <pre class="codeinput">smt.init(ugv, max_sensors_under_attack, safe_sensors, noise_bound);</pre>
		</div>
        </p>
        <p>
        Imhotep-SMT will check the <i>security index</i> for the system, and make sure 
        it matches the specified maximum number of sensors under attack.
        In this case, the following report is generated:
        <div class="content">
        <pre class="codeoutput">Theoretical upper bound on maximum number of attacks is: 0
 
ERROR: System structure does not match the specified maximum number of attacked sensors
Maximum number of attacked sensors must be less than 0
 
Sensors that can improve system security are: Sensor#1</pre>
		</div>
        </p>
        
        <p>
        	The generated report warns the user that the specified system can not tolerate any attacks
        	on its sensors. The structure of the system is such that a 
        	corruption to the sensor measurements can preclude <i>any</i> 
        	security algorithm from detecting the attack. In other words, if all the sensors are allowed to be 
        	attacked, it is theoretically not possible to detect the attack. 
        	To avoid this situation, Imhotep-SMT suggests that the  
        	security level of the system can be potentially increased if the GPS signal (sensor 1) 
        	is not attacked. 
        	Therefore, we re-define the set of safe sensors as:
        	<div class="content">
        	<pre class="codeinput">safe_sensors = [1];</pre>
			</div>
        </p>
        
        <p>
        and initialize the solver again as follows:
        <div class="content">
        <pre class="codeinput">smt.init(sys, max_sensors_under_attack, safe_sensors, noise_bound);</pre>
        <pre class="codeoutput">Theoretical upper bound on maximum number of attacks is: 2
 
Disclaimer: Correction of the solver outputs is guaranteed if and only if
the specified system is observable after removing all combinations of 2 unsafe sensors.
To run this combinatorial test, call the checkObservabilityCondition()</pre>
		</div>
    	</p>
    	
    	<p>
    	The final step to complete the offline configuration phase consists in checking 
    	the sparse observability condition. This is the necessary
    	and sufficient condition to guarantee the correctness of the results. Depending
    	on the structure of the system, the test may take some time. 
    	This step can be skipped if the user knows that 
    	the sparse observability condition holds for the specified system.
    	<div class="content">
        <pre class="codeinput">smt.checkObservabilityCondition(1E-20);</pre>
        <pre class="codeoutput">Calculating lower bound on the number of sensors that can be attacked...
lower bound is equal to 0
 
 
The specified "number of sensors under attack" lies between the theoretical
upper and lower bounds ...
Checking the observability of 1 combinations ... This may take some time
 
Iteration number 1 out of 1 combinations ... PASS!
Sparse observability condition passed! Solver is ready to run!</pre>
		</div>
    	
    	</p>
    <br />
        
        
        

        <h2>Step 2- Online State Estimation </h2>
        <p>
        	To detect the attack, we need to provide the solver with the input and output signals
        	of the system to be controlled, as shown in the figure below.
        	<br /><br /><br />
        	<img src="./images/Imhotep_SMT.png" alt="Imhotep-SMT" style="width:504px;height:328px">
        	<br />
        	Since the solver is implemented within Matlab, we need to use the capabilities embedded in
        	the "Real-time toolbox" of Matlab to deploy it on a real application while 
        	guaranteeing real-time operation. However, for the purpose of this tutorial, we simply 
        	use Matlab to simulate the dynamical system as follows.
        	<div class="content">
        	<pre class="codeinput">x = randn(2,1); %unknown initial condition
attacked_sensor_index = 2; % the attacker chooses to attack the second sensor.
for t = 1 : 1000	% simulate the system for 1000 time steps
    y   = C*x;		% the system measurements 
    % the attacker corrupts the second sensor with random data
    y(attacked_sensor_index) = y(attacked_sensor_index) + 50*randn(1); 
    
    F   = 1;		% the force supplied to the UGV
    x   = A*x + B*F;	% simulate the system
    
    [xhat, sensor_under_attack] = smt.addInputsOutputs(F, y);
    error = norm(xhat - x)
    sensor_under_attack
end</pre>
        	</div>
        </p>
        <p>
        Except for the first iteration, the code above results into the following output 
        at each iteration of the simulation:
        <div class="content">
        <pre class="codeoutput">error =
     8.8818e-16
sensor_under_attack =
     2</pre>
		</div>
        </p>
        <p>
        In general, for the first $n-1$ iterations (where $n$ is the number of state variables of the
        system), the output of the solver may be incorrect since the information stored is not 
        enough to correctly compute the state and determine which sensors are under attack.
        </p>
        <br />


        <br />
      </div>
      <!--
      <div id="rightbar">
        <h2>latest news</h2>
        <p><span class="orangetext">24 Jan. 2015</span><br />
          New features added to Imhotep-SMT. <br />
          <br />
          <span class="orangetext">15 Dec. 2014</span><br />
          New journal paper describing the theory behind "Imhotep-SMT" is submitted. A preprint version can be accessed through arXiv.<br />
          <br />
          <span class="orangetext">28 Oct. 2014</span><br />
          First version of Imohtep-SMT is released.
        </p>
      </div>
    </div>
    -->
    <div id="bottom">
    <!--
      <div id="email"><a href="mailto:info@yourcompany.com">info@yourcompany.com</a></div>
      <div id="validtext">
        <p>Valid <a href="http://validator.w3.org/check?uri=referer">XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a></p>
      </div>
      -->
    </div>
  </div>
</div>
</body>
</html>
